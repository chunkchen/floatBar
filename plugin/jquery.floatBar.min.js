/*
 * floatBar v1.1
 * Copyright (c) 2013 Wendell  http://blog.webql.info/
 * https://github.com/wendellvian/floatBar.git
*/

!function(a){a.fn.extend({floatBar:function(b){function g(c){var h,i,j,g=a(window).scrollTop();for(d.find("."+b.eleFocus).removeClass(b.eleFocus),h=0,i=e.length;i>h;h++)if(f=e[h],j=g+c.oWinHeight-f.height*(e.length-1)/e.length,f.top>g){f.top>j&&(f=e[h-1]),f&&d.find(b.eleLabel).eq(f.index-1).addClass(b.eleFocus);break}}function h(a){switch(b.middle){case"bottom":return d.data(a,parseInt(d.css(a))),d.data(a);case"top":return d.data(a,parseInt(d.css(a))),-1!=navigator.userAgent.indexOf("MSIE 6")&&d.data(a,parseInt(d.css("margin-top"))),d.data(a)}}function l(){var c,f,h,i,e={};if(e.oWinWidth=a(window).width(),e.oWinHeight=a(window).height(),e.oFloatElementWidth=d.width(),oWinTop=a(window).scrollTop(),f=(e.oWinWidth-b.bodyWidth)/2-e.oFloatElementWidth-b.spaceWidth,h=f+(b.bodyWidth+e.oWinWidth)/2+b.spaceWidth,i=h-(e.oWinWidth-b.bodyWidth)/2+e.oFloatElementWidth+b.spaceWidth,e.oWinWidth<=(e.oWinWidth-b.bodyWidth)/2+b.bodyWidth+e.oFloatElementWidth+b.spaceWidth){switch(b.align){case"right":c={right:"0"};break;case"left":c={right:h}}d.css(c)}else{switch(b.align){case"right":c={right:f};break;case"left":c={right:i}}d.css(c)}return b.moveOnOff?m(e):" ",b.focusOnOff?g(e):" ",e}function m(a){var c=function(a,c){switch(b.middle){case"bottom":b.aniOnOff?d.stop().animate(a,b.speed):d.css(a);break;case"top":b.aniOnOff?d.stop().animate(c,b.speed):d.css(c)}};-1!=navigator.userAgent.indexOf("MSIE 6")?oWinTop<b.liveHeight&&a.oWinHeight>b.winMinHeight?c({marginTop:"0"},{marginTop:j}):oWinTop<b.liveHeight&&a.oWinHeight<b.winMinHeight?c({marginTop:"0"},{marginTop:b.topFixHeight}):oWinTop>b.liveHeight&&a.oWinHeight>b.winMinHeight?c({marginTop:-i},{marginTop:b.topFixHeight}):oWinTop>b.liveHeight&&a.oWinHeight<b.winMinHeight&&c({marginTop:"0"},{marginTop:b.topFixHeight}):oWinTop<b.liveHeight&&a.oWinHeight>b.winMinHeight?c({bottom:"0"},{top:j}):oWinTop<b.liveHeight&&a.oWinHeight<b.winMinHeight?c({bottom:"0"},{top:b.topFixHeight}):oWinTop>b.liveHeight&&a.oWinHeight>b.winMinHeight?c({bottom:i},{top:b.topFixHeight}):oWinTop>b.liveHeight&&a.oWinHeight<b.winMinHeight&&c({bottom:"0"},{top:b.topFixHeight})}var d,e,f,i,j,k,c={liveHeight:360,bodyWidth:960,winMinHeight:600,topFixHeight:30,spaceWidth:10,align:"right",middle:"bottom",speed:300,aniOnOff:!0,moveOnOff:!0,eleFocus:"focus",eleName:"back",eleLabel:"li",anchorIndex:"anchor-index",eleMargin:10,mouseCtrl:"click",focusOnOff:!0};return b=a.extend(c,b),d=a(this),e=[],a("["+b.anchorIndex+"]").each(function(){e.push({index:a(this).attr(b.anchorIndex),height:a(this).height(),top:a(this).offset().top})}),d.find(b.eleLabel).bind(b.mouseCtrl,function(){var c=a(this).index()+1,d=a("["+b.anchorIndex+"="+c+"]");return a("html,body").stop().animate({scrollTop:d.offset().top-b.eleMargin},b.speed),!1}),d.find("."+b.eleName+"top").click(function(){a("html,body").stop().animate({scrollTop:0},b.speed)}),d.find("."+b.eleName+"bottom").click(function(){a("html,body").stop().animate({scrollTop:a("body").height()},b.speed)}),i=h("bottom"),j=h("top"),k=l(),d.show(),a(window).resize(function(){l()}),a(window).scroll(function(){oWinTop=a(window).scrollTop(),b.moveOnOff?m(k):" ",b.focusOnOff?g(k):" "}),a(this)}})}(jQuery);
